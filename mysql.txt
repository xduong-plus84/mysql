DROP DATABASE IF EXISTS food_app;
CREATE DATABASE food_app;
USE food_app;

DROP TABLE IF EXISTS restaurant;
CREATE TABLE restaurant(
	res_id INT AUTO_INCREMENT PRIMARY KEY,
    res_name VARCHAR(100) NOT NULL,
    res_image VARCHAR(100) NOT NULL DEFAULT "Hinh default",
    res_desc VARCHAR(100)
);

DROP TABLE IF EXISTS users;
CREATE TABLE users(
	user_id INT AUTO_INCREMENT PRIMARY KEY,
    full_name VARCHAR(100),
    email VARCHAR(100),
    password VARCHAR(100)
);

DROP TABLE IF EXISTS rate_res;
CREATE TABLE rate_res(
	res_id INT,
	user_id INT,
    amount INT,
    date_rate DATETIME,
    PRIMARY KEY (res_id,user_id),
    FOREIGN KEY (res_id) REFERENCES restaurant(res_id),
    FOREIGN KEY (user_id) REFERENCES users(user_id)
);

DROP TABLE IF EXISTS like_res;
CREATE TABLE like_res(
	user_id INT,
	res_id INT,
    date_like DATETIME,
    PRIMARY KEY (res_id, user_id),
    FOREIGN KEY (res_id) REFERENCES restaurant(res_id),
    FOREIGN KEY (user_id) REFERENCES users(user_id)
);

DROP TABLE IF EXISTS food_type;
CREATE TABLE food_type (
	type_id INT AUTO_INCREMENT PRIMARY KEY,
    type_name VARCHAR(100)
);


DROP TABLE IF EXISTS foods;
CREATE TABLE foods(
	food_id INT AUTO_INCREMENT PRIMARY KEY,
    food_name VARCHAR(100),
    image VARCHAR(100),
    price FLOAT,
    food_desc VARCHAR(500),
    type_id INT,
    FOREIGN KEY (type_id) REFERENCES food_type(type_id)
);

DROP TABLE IF EXISTS orders;
CREATE TABLE orders(
	user_id INT,
    food_id INT,
    amount INT,
    code VARCHAR(100),
    arr_sub_id VARCHAR(150),
    PRIMARY KEY (user_id, food_id),
    FOREIGN KEY (user_id) REFERENCES users(user_id),
    FOREIGN KEY (food_id) REFERENCES foods(food_id)
);

DROP TABLE IF EXISTS sub_food;
CREATE TABLE sub_food(
	sub_id INT AUTO_INCREMENT PRIMARY KEY,
    sub_name VARCHAR(100),
    sub_price FLOAT,
    food_id INT,
    FOREIGN KEY (food_id) REFERENCES foods(food_id)
);
